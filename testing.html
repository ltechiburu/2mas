<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>DrinkSeattle</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js">
  <style>
    body {
      overflow-x: hidden;
    }

    .navbar {
      text-transform: uppercase;
      font-family: Montserrat, "Helvetica Neue", Helvetica, Arial, sans-serif;
      font-weight: 700;
    }

    .navbar a:focus {
      outline: 0;
    }

    .navbar .navbar-nav {
      letter-spacing: 1px;
    }

    .navbar .navbar-nav li a:focus {
      outline: 0;
    }

    .navbar-default,
    .navbar-inverse {
      border: 0;
    }
    header {
      position: relative;
      background-color: #4d1c31; /* Maroon color */
      text-align: center;
      color: #fff; /* White text color, adjust as needed */
    }

    header .container {
      padding-top: 100px;
      padding-bottom: 50px;
    }
header .credit {
  font-style: italic;
  font-size: 0.8em; /* Adjust the font size as needed */
  position: absolute;
  bottom: 10px; /* Adjust the distance from the bottom */
  left: 50%;
  transform: translateX(-50%);
}
    @media(min-width:768px) {
      header .container {
        padding-top: 200px;
        padding-bottom: 100px;
      }

      .navbar-fixed-top {
        padding: 25px 0;
        -webkit-transition: padding .3s;
        -moz-transition: padding .3s;
        transition: padding .3s;
      }

      .navbar-fixed-top .navbar-brand {
        font-size: 2em;
        -webkit-transition: all .3s;
        -moz-transition: all .3s;
        transition: all .3s;
      }

      .navbar-fixed-top.navbar-shrink {
        padding: 10px 0;
      }

      .navbar-fixed-top.navbar-shrink .navbar-brand {
        font-size: 1.5em;
      }
    }

    /* Additional styles for the header */
    header .intro-text .page-title {
      font-family: Montserrat, "Helvetica Neue", Helvetica, Arial, sans-serif;
      font-size: 4.5em; /* Adjust the font size as needed */
      font-weight: 700;
    }
    }
  </style>
</head>

<body id="page-top">
  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top">
    <div class="container">
      <a class="navbar-brand" href="https://ltechiburu.github.io/2mas/">
  Tomas Echiburu
</a>
    </div>
  </nav>

  <!-- Header -->
  <header>
    <div class="container">
      <div class="intro-text">
        <div class="intro-heading text-uppercase page-title">TESTING SITE</div>
        <div class="intro-subheading">
          After 7 years in Seattle, I have found myself enjoying happy hour beers, post-bike ride rewards, late night
          cocktails and more, all around the city. Below is a guide with some of the most notable places I have
          frequented over the years.
          <br> <br> Green pins are places I would recommend to a friend, while red pins are places I think you should
          avoid. A yellow pin means decide for yourself <br>
<em class="credit">Map created with Google Maps API technology. Markers, reviews, and page formatting coded in HTML, JavaScript, CSS.</em>

        </div>
      </div>
    </div>
  </header>
  <!-- Map Container -->
  <br>
  
let activeFilter = false;
let filteredBars = [];

 function initMap() {
  const map = new google.maps.Map(document.getElementById('map'), {
    center: { lat: 47.6062, lng: -122.3321 }, // Seattle coordinates
    zoom: 12
  });

  // Add markers and info windows
  bars.forEach(bar => {
    const marker = new google.maps.Marker({
      position: { lat: bar.lat, lng: bar.lng },
      map: map,
      title: bar.name,
      icon: getMarkerIcon(bar.rating), // Set the marker icon based on rating
    });
    const infowindow = new google.maps.InfoWindow({
      content: `<div style="font-size:16px;"><strong class="bar-marker">${bar.name}</strong> - <em>${bar.neighborhood}</em></div>` +
        `<div style="font-size:18px;">Rating: ${getRatingStars(bar.rating)}</div>` +
        `<div style="font-size:14px;">${bar.description}</div>`
    });

    marker.addListener('click', function () {
      infowindow.open(map, marker);
    });
  });

  // Display bar information below the map
  bars.forEach(bar => {
    displayBarInfo(bar);
  });
}

// Helper function to get marker icon based on rating
function getMarkerIcon(rating) {
  if (!isNaN(rating)) {
    if (rating >= 4) {
      return {
        url: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png',
        scaledSize: new google.maps.Size(32, 32),
        origin: new google.maps.Point(0, 0),
        anchor: new google.maps.Point(16, 32),
      };
    } else if (rating >= 3) {
      return {
        url: 'http://maps.google.com/mapfiles/ms/icons/yellow-dot.png',
        scaledSize: new google.maps.Size(32, 32),
        origin: new google.maps.Point(0, 0),
        anchor: new google.maps.Point(16, 32),
      };
    }
  }

  return {
    url: 'http://maps.google.com/mapfiles/ms/icons/red-dot.png',
    scaledSize: new google.maps.Size(32, 32),
    origin: new google.maps.Point(0, 0),
    anchor: new google.maps.Point(16, 32),
  };
}


  // Helper function to get star ratings
  function getRatingStars(rating) {
    const fullStars = "★".repeat(Math.floor(rating));
    const halfStar = (rating % 1 !== 0) ? "½" : "";
    const emptyStars = "☆".repeat(Math.floor(5 - rating));
    return `${fullStars}${halfStar}${emptyStars}`;
  }

  function displayBarInfo(bar) {
    const barsContainer = document.getElementById("barsContainer");
    const barElement = document.createElement("div");
    barElement.classList.add("bar-info");
    
    barElement.innerHTML = `<div class="bar-name"><strong>${bar.name}</strong> - <span class="neighborhood"><em>${bar.neighborhood}</em></span></div>` +
      `<div>${getRatingStars(bar.rating)}</div>` +
      `<div class="description">${bar.description}</div>` +
      `<hr>`;

    barsContainer.appendChild(barElement);
  }
    
   // Function for sort ability
function sortBars() {
  const sortOptions = document.getElementById("sortOptions");
  const selectedOption = sortOptions.value;

  if (selectedOption === "rating") {
    if (activeFilter) {
      // Sort the filtered bars by rating
      filteredBars.sort((a, b) => b.rating - a.rating);
    } else {
      // Sort all bars by rating
      bars.sort((a, b) => b.rating - a.rating);
    }
  } else if (selectedOption === "neighborhood") {
    if (activeFilter) {
      // Sort the filtered bars by neighborhood
      filteredBars.sort((a, b) => a.neighborhood.localeCompare(b.neighborhood));
    } else {
      // Sort all bars by neighborhood
      bars.sort((a, b) => a.neighborhood.localeCompare(b.neighborhood));
    }
  }

  // Clear the current barsContainer content
  const barsContainer = document.getElementById("barsContainer");
  barsContainer.innerHTML = '';

  // Display the sorted bars
  const barsToDisplay = activeFilter ? filteredBars : bars;
  barsToDisplay.forEach(bar => {
    displayBarInfo(bar);
  });
}

    
// Function to generate neighborhood options
    function generateNeighborhoodOptions() {
      const neighborhoodDropdown = document.getElementById("filterNeighborhoodDropdown");
      const uniqueNeighborhoods = [...new Set(bars.map(bar => bar.neighborhood))];
      // Count reviews for each neighborhood
  const neighborhoodsCount = uniqueNeighborhoods.reduce((count, neighborhood) => {
    count[neighborhood] = bars.filter(bar => bar.neighborhood === neighborhood).length;
    return count;
  }, {});
      // Sort neighborhoods alphabetically
  uniqueNeighborhoods.sort();
      // Clear existing options
      neighborhoodDropdown.innerHTML = '';
// Add Apply button
  const applyButton = document.createElement("button");
  applyButton.innerText = "Apply";
  applyButton.addEventListener("click", applyFilter);
  neighborhoodDropdown.appendChild(applyButton);
      // Add Clear Filter button
  const clearFilterButton = document.createElement("button");
  clearFilterButton.innerText = "Clear Filter";
  clearFilterButton.addEventListener("click", clearFilter); // Attach the clear filter function
  neighborhoodDropdown.appendChild(clearFilterButton);
      // Populate neighborhood options
      uniqueNeighborhoods.forEach(neighborhood => {
        const label = document.createElement("label");
        const checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        checkbox.value = neighborhood;
        label.appendChild(checkbox);
        label.appendChild(document.createTextNode(` ${neighborhood} (${neighborhoodsCount[neighborhood]})`));

        neighborhoodDropdown.appendChild(label);
      });
    }

// Function to apply the selected filter
function applyFilter() {
  const selectedNeighborhoods = Array.from(document.querySelectorAll('#filterNeighborhoodDropdown input[type="checkbox"]:checked'))
    .map(checkbox => checkbox.value);

 filteredBars = bars.filter(bar => selectedNeighborhoods.includes(bar.neighborhood));
  activeFilter = true;
  
  // Clear the current barsContainer content
  const barsContainer = document.getElementById("barsContainer");
  barsContainer.innerHTML = '';

  // Display the filtered bars
  filteredBars.forEach(bar => {
    displayBarInfo(bar);
  });
}
    // Function to clear the filter
function clearFilter() {
  const checkboxes = document.querySelectorAll('#filterNeighborhoodDropdown input[type="checkbox"]');
  checkboxes.forEach(checkbox => {
    checkbox.checked = true;
  });
 
  activeFilter = false;
  applyFilter(); // Reapply filter to show all reviews
}
    // Call the function to generate neighborhood options when the page loads
    generateNeighborhoodOptions();

// Add this function to your existing JavaScript code
function toggleDropdown() {
  const dropdown = document.querySelector(".neighborhood-dropdown");
  dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
}

   // Add a scroll event listener to toggle the visibility of the dynamic text
   document.addEventListener('scroll', function () {
  // Get the height of the maroon header
  var maroonHeaderHeight = document.querySelector('header').offsetHeight;
  // Get the scroll position
  var scrollPosition = window.scrollY;

  var threshold = maroonHeaderHeight * 0.5;

  // Check if the scroll position is greater than or equal to the threshold
  if (scrollPosition >= threshold) {
    // Show the dynamic text on the navbar
    document.querySelector('.navbar-brand .dynamic-text').style.display = 'block';
  } else {
    // Hide the dynamic text on the navbar
    document.querySelector('.navbar-brand .dynamic-text').style.display = 'none';
  }
});
   
  </script>
</body>

</html>
